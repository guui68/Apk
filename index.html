<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TeraBox Pro Downloader</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background-color: #0f172a; color: white; scroll-behavior: smooth; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .gradient-text { background: linear-gradient(90deg, #3b82f6, #10b981); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 md:p-10">

    <div class="w-full max-w-3xl">
        <div class="text-center mb-10">
            <h1 class="text-5xl font-black mb-3 gradient-text">TeraBox DL</h1>
            <p class="text-gray-400 text-lg">ফাইল প্লে করুন এবং হাই-স্পিড ডাউনলোড করুন</p>
        </div>

        <div class="glass p-8 rounded-3xl shadow-2xl mb-8">
            <div class="flex flex-col gap-4">
                <div class="relative">
                    <input type="text" id="teraUrl" placeholder="TeraBox লিঙ্কটি এখানে পেস্ট করুন..." 
                        class="w-full bg-gray-900 border border-gray-700 p-5 pl-12 rounded-2xl focus:outline-none focus:border-blue-500 transition-all text-white text-lg shadow-inner">
                    <i class="fa-solid fa-link absolute left-4 top-1/2 -translate-y-1/2 text-gray-500"></i>
                </div>
                <button onclick="handleDownload()" id="actionBtn" 
                    class="w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 py-5 rounded-2xl font-bold text-xl shadow-lg transform active:scale-95 transition-all flex items-center justify-center gap-3">
                    <i class="fa-solid fa-magic"></i> ফাইলটি খুঁজুন
                </button>
            </div>
        </div>

        <div id="loadingStatus" class="hidden text-center py-10">
            <div class="inline-block animate-spin rounded-full h-14 w-14 border-t-4 border-b-4 border-blue-500 mb-4"></div>
            <p class="text-blue-400 font-semibold text-lg">আপনার ডেটা প্রসেস হচ্ছে, অনুগ্রহ করে অপেক্ষা করুন...</p>
        </div>

        <div id="outputArea" class="hidden glass rounded-3xl overflow-hidden p-6 animate-in fade-in duration-500 border border-blue-500/30">
            <div class="flex items-center gap-3 mb-6">
                <div class="bg-blue-500 p-3 rounded-xl">
                    <i class="fa-solid fa-file-video text-2xl"></i>
                </div>
                <h2 id="fileName" class="text-xl font-bold text-gray-100 truncate"></h2>
            </div>
            
            <div class="rounded-2xl overflow-hidden bg-black mb-8 aspect-video border border-gray-800 shadow-2xl">
                <video id="videoPlayer" controls class="w-full h-full">
                    <source id="videoSource" src="" type="video/mp4">
                    আপনার ব্রাউজার ভিডিও প্লে সাপোর্ট করে না।
                </video>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <a id="downloadLink" href="#" target="_blank" 
                    class="bg-emerald-600 hover:bg-emerald-500 text-center py-5 rounded-2xl font-black text-lg shadow-lg transition-all flex items-center justify-center gap-2">
                    <i class="fa-solid fa-download"></i> সরাসরি ডাউনলোড
                </a>
                <button onclick="copyToClipboard()" 
                    class="bg-gray-800 hover:bg-gray-700 text-center py-5 rounded-2xl font-bold text-lg transition-all flex items-center justify-center gap-2">
                    <i class="fa-solid fa-copy"></i> লিঙ্ক কপি করুন
                </button>
            </div>
        </div>
    </div>

    <script>
        async function handleDownload() {
            const inputField = document.getElementById('teraUrl');
            const loader = document.getElementById('loadingStatus');
            const output = document.getElementById('outputArea');
            const btn = document.getElementById('actionBtn');

            // আপনার নতুন API লিঙ্কটি এখানে আপডেট করা হয়েছে
            const API_ENDPOINT = "https://gxterabox.samimtt9.workers.dev";

            if (!inputField.value.trim()) {
                alert("দয়া করে একটি বৈধ লিঙ্ক প্রদান করুন!");
                return;
            }

            // UI আপডেট
            loader.classList.remove('hidden');
            output.classList.add('hidden');
            btn.disabled = true;
            btn.style.opacity = "0.7";

            try {
                // API থেকে ডেটা ফেচ করা
                const response = await fetch(`${API_ENDPOINT}/?url=${encodeURIComponent(inputField.value.trim())}`);
                const data = await response.json();

                if (data && data.list && data.list.length > 0) {
                    const fileInfo = data.list[0];
                    const finalUrl = fileInfo.download_urls['fast'] || fileInfo.download_urls['standard'];

                    // ডেটা বসানো
                    document.getElementById('fileName').innerText = fileInfo.filename;
                    document.getElementById('videoSource').src = finalUrl;
                    document.getElementById('downloadLink').href = finalUrl;
                    
                    // প্লেয়ার লোড করা
                    const player = document.getElementById('videoPlayer');
                    player.load();

                    loader.classList.add('hidden');
                    output.classList.remove('hidden');
                    
                    // রেজাল্ট সেকশনে স্ক্রোল করা
                    output.scrollIntoView({ behavior: 'smooth' });
                } else {
                    alert("দুঃখিত! এই লিঙ্ক থেকে কোনো ফাইল পাওয়া যায়নি।");
                    loader.classList.add('hidden');
                }
            } catch (error) {
                console.error("Error:", error);
                alert("সার্ভার এরর! আপনার Cloudflare Worker-এর কোডটি ঠিকমতো কাজ করছে না।");
                loader.classList.add('hidden');
            } finally {
                btn.disabled = false;
                btn.style.opacity = "1";
            }
        }

        function copyToClipboard() {
            const link = document.getElementById('videoSource').src;
            navigator.clipboard.writeText(link);
            alert("ডাউনলোড লিঙ্কটি ক্লিপবোর্ডে কপি করা হয়েছে!");
        }
    </script>
</body>
</html>
